window.docxtemplater=function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,r){"use strict";function n(e){return e[0]}function o(e){return e[e.length-1]}function a(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}function i(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}function s(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}function u(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}function l(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}function p(e){var t=new i("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t}function c(e){var t=new i("Unopened tag");return t.properties={xtag:o(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unopened'},t}function f(e){var t=new i("Unclosed tag");return t.properties={xtag:n(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unclosed'},t}function h(e){var t=new i('No tag "'+e.element+'" was found at the '+e.position);throw t.properties={id:"no_xml_tag_found_at_"+e.position,explanation:'No tag "'+e.element+'" was found at the '+e.position,parsed:e.parsed,index:e.index,element:e.element},t}function d(e){var t=new l("End");throw t.properties={id:"utf8_decode",data:e,explanation:"Could not decode string to UTF8"},t}function g(e){var t=new l("Content must be a string");throw t.properties.id="xmltemplater_content_must_be_string",t.properties.type=e,t}function v(e){var t=new i("Raw tag not in paragraph"),r=e.part,n=r.value,o=r.offset;throw t.properties={id:"raw_tag_outerxml_invalid",explanation:'The tag "'+n+'" is not inside a paragraph',rootError:e.rootError,xtag:n,offset:o,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},t}function m(e){var t=new i("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The tag "'+r+'" should be the only text in this paragraph',xtag:e.part.value,offset:e.part.offset,paragraphParts:e.paragraphParts},t}function y(e){var t=e.location,r="start"===t?"unclosed":"unopened",n="start"===t?"Unclosed":"Unopened",o=new i(n+" loop"),a=e.part.value;return o.properties={id:r+"_loop",explanation:'The loop with tag "'+a+'" is '+r,xtag:a},o}function x(e){var t=e.tags,r=new i("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'+t[0].value+'" is closed by the tag "'+t[1].value+'"',openingtag:t[0].value,offset:[t[0].offset,t[1].offset],closingtag:t[1].value},r}function w(e){var t=e.tag,r=e.rootError,n=new u("Scope parser compilation failed");return n.properties={id:"scopeparser_compilation_failed",tag:t,explanation:'The scope parser for the tag "'+t+'" failed to compile',rootError:r},n}function T(e){var t=e.tag,r=new i('The position of the loop tags "'+t+'" would produce invalid XML');return r.properties={tag:t,id:"loop_position_invalid",explanation:'The tags "'+t+'" are misplaced in the document, for example one of them is in a table and the other one outside the table'},r}function b(e){var t=new i('Unimplemented tag type "'+e.type+'"');throw t.properties={part:e,id:"unimplemented_tag_type"},t}function E(e){var t=new l("Malformed xml");throw t.properties={part:e,id:"malformed_xml"},t}function k(e){throw new l('Location should be one of "start" or "end" (given : '+e.location+")")}function M(e){var t=new l('The filetype "'+e+'" is not handled by docxtemplater');throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'+e+'", but only docx and pptx formats are handled'},t}function P(){var e=new l("The filetype for this file could not be identified, is this file corrupted ?");throw e.properties={id:"filetype_not_identified"},e}a.prototype=Error.prototype,i.prototype=new a,s.prototype=new a,u.prototype=new a,l.prototype=new a,e.exports={XTError:a,XTTemplateError:i,XTInternalError:l,XTScopeParserError:u,RenderingError:s,throwMultiError:p,throwXmlTagNotFound:h,throwDecodeUTF8Error:d,throwContentMustBeString:g,getUnmatchedLoopException:y,throwRawTagShouldBeOnlyTextInParagraph:m,throwRawTagNotInParagraph:v,getClosingTagNotMatchOpeningTag:x,throwUnimplementedTagType:b,getScopeCompilationError:w,getUnopenedTagException:c,getUnclosedTagException:f,throwMalformedXml:E,throwFileTypeNotIdentified:P,throwFileTypeNotHandled:M,getLoopPositionProducesInvalidXMLError:T,throwLocationInvalid:k}},function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){return n({},"get",function(t){return"."===e?t:t[e]})}var a=r(6),i=a.DOMParser,s=a.XMLSerializer,u=r(0),l=u.throwXmlTagNotFound,p={};p.defaults={nullGetter:function(e){return e.module?(e.module,""):"undefined"},parser:o,delimiters:{start:"{",end:"}"}},p.mergeObjects=function(){for(var e={},t=void 0,r=void 0,n=0;n<arguments.length;n+=1){t=arguments[n],r=Object.keys(t);for(var o=0;o<r.length;o+=1)e[r[o]]=t[r[o]]}return e},p.xml2str=function(e){return(new s).serializeToString(e)},p.str2xml=function(e,t){return new i({errorHandler:t}).parseFromString(e,"text/xml")},p.charMap={"&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;",'"':"&quot;"};var c=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;p.escapeRegExp=function(e){return e.replace(c,"\\$&")},p.charMapRegexes=Object.keys(p.charMap).map(function(e){var t=p.charMap[e];return{rstart:new RegExp(p.escapeRegExp(t),"g"),rend:new RegExp(p.escapeRegExp(e),"g"),start:t,end:e}}),p.wordToUtf8=function(e){for(var t=void 0,r=0,n=p.charMapRegexes.length;r<n;r++)t=p.charMapRegexes[r],e=e.replace(t.rstart,t.end);return e},p.utf8ToWord=function(e){"string"!=typeof e&&(e=e.toString());for(var t=void 0,r=0,n=p.charMapRegexes.length;r<n;r++)t=p.charMapRegexes[r],e=e.replace(t.rend,t.start);return e},p.concatArrays=function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],o=0,a=n.length;o<a;o++)t.push(n[o]);return t};var f=new RegExp(String.fromCharCode(160),"g");p.convertSpaces=function(e){return e.replace(f," ")},p.pregMatchAll=function(e,t){for(var r=[],n=void 0;null!=(n=e.exec(t));)r.push({array:n,offset:n.index});return r},p.getRight=function(e,t,r){for(var n=r,o=e.length;n<o;n++){if(e[n].value==="</"+t+">")return n}l({position:"right",element:t,parsed:e,index:r})},p.getLeft=function(e,t,r){for(var n=r;n>=0;n--){var o=e[n];if(0===o.value.indexOf("<"+t)&&-1!==[">"," "].indexOf(o.value[t.length+1]))return n}l({position:"left",element:t,parsed:e,index:r})},e.exports=p},function(e,t,r){"use strict";function n(){}function o(e){return e}e.exports=function(e){var t={set:n,parse:n,render:n,getTraits:n,optionsTransformer:o,errorsTransformer:o,getRenderedMap:o,postparse:o,on:n};if(Object.keys(t).every(function(t){return!e[t]}))throw new Error("This module cannot be wrapped, because it doesn't define any of the necessary functions");return Object.keys(t).forEach(function(r){e[r]=e[r]||t[r]}),e}},function(e,t,r){"use strict";function n(e,t){if(0===e.length)return!1;var r=e[e.length-1],n=r.tag.substr(1),o=t.substr(2,t.length-3);return 0===n.indexOf(o)}function o(e,t){return e.push({tag:t}),e}function a(e){for(var t,r=e.filter(function(e){return"tag"===e.type}).map(function(e){return e.value}),a=[],i=0;i<r.length;i++)t=r[i],"/"===t[1]?n(a,t)?a.pop():a=o(a,t):"/"!==t[t.length-1]&&(a=o(a,t));return a}function i(e,t){for(var r=0;r<t.length;r++){if(0===t[r].tag.indexOf(e))return!0}return!1}function s(e,t){var r=a(e);return r.filter(function(e){return"/"===e.tag[1]}).length!==r.filter(function(e){var t=e.tag;return"/"!==t[1]&&"/"!==t[t.length-2]}).length?{error:m({tag:t[0].part.value})}:i("<w:tc",r)?{value:"w:tr"}:i("<a:tc",r)?{value:"a:tr"}:{value:!1}}function u(e,t,r){var n=e.expandTo||r.expandTo,o=t.indexOf(e);if(!n)return t;var a=void 0,i=void 0;try{a=c(t,n,o),i=f(t,n,o)}catch(r){throw r instanceof g&&v({part:e,rootError:r,postparsed:t,expandTo:n,index:o}),r}var s=t.slice(i,o),u=t.slice(o+1,a+1),l=r.getInner({index:o,part:e,leftParts:s,rightParts:u,left:i,right:a,postparsed:t});return l.length||(l.expanded=[s,u],l=[l]),h([t.slice(0,i),l,t.slice(a+1)])}function l(e,t){var r=[];return e.errors&&(r=e.errors,e=e.postparsed),e.reduce(function(e,r){return"placeholder"===r.type&&r.module===t.moduleName&&e.push(r),e},[]).forEach(function(n){try{e=u(n,e,t)}catch(e){if(!(e instanceof g))throw e;r.push(e)}}),{postparsed:e,errors:r}}var p=r(1),c=p.getRight,f=p.getLeft,h=p.concatArrays,d=r(0),g=d.XTTemplateError,v=d.throwRawTagNotInParagraph,m=d.getLoopPositionProducesInvalidXMLError;e.exports={expandToOne:l,getExpandToDefault:s}},function(e,t,r){"use strict";function n(e){function t(){var t={array:Array.prototype.slice.call(arguments)};t.array.shift();var r=t.array[0]+t.array[1];t.array.unshift(r),t.array.pop();var n=t.array.pop();t.offset=n,t.first=!0,e.matches.unshift(t)}function r(){var t={array:Array.prototype.slice.call(arguments)};t.array.pop();var r=t.array.pop();t.offset=r,t.last=!0,-1===t.array[0].indexOf("/>")&&e.matches.push(t)}-1===e.content.indexOf("<")&&-1===e.content.indexOf(">")&&e.content.replace(/^()([^<>]*)$/,t);var n=new RegExp("^()([^<]+)</(?:"+e.tagsXmlArrayJoined+")>");return e.content.replace(n,t),n=new RegExp("(<(?:"+e.tagsXmlArrayJoined+")[^>]*>)([^>]+)$"),e.content.replace(n,r),e}var o=r(1),a=o.pregMatchAll;e.exports=function(e,t){var r={};r.content=e,r.tagsXmlArray=t,r.tagsXmlArrayJoined=r.tagsXmlArray.join("|");var o=new RegExp("(?:(<(?:"+r.tagsXmlArrayJoined+")[^>]*>)([^<>]*)</(?:"+r.tagsXmlArrayJoined+")>)|(<(?:"+r.tagsXmlArrayJoined+")[^>]*/>)","g");return r.matches=a(o,r.content),n(r)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1);a.traits=r(3),a.moduleWrapper=r(2);var i=a.defaults,s=a.str2xml,u=a.xml2str,l=a.moduleWrapper,p=a.concatArrays,c=r(0),f=c.XTInternalError,h=c.throwFileTypeNotIdentified,d=c.throwFileTypeNotHandled,g=function(){function e(){if(n(this,e),arguments.length>0)throw new Error("The constructor with parameters has been removed in docxtemplater 3.0, please check the upgrade guide.");this.compiled={},this.modules=[],this.setOptions({})}return o(e,[{key:"setModules",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:"sendEvent",value:function(e){this.modules.forEach(function(t){t.on(e)})}},{key:"attachModule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.prefix;return r&&(e.prefix=r),this.modules.push(l(e)),this}},{key:"setOptions",value:function(e){var t=this;return this.options=e,Object.keys(i).forEach(function(e){var r=i[e];t[e]=null!=t.options[e]?t.options[e]:r}),this.zip&&this.updateFileTypeConfig(),this}},{key:"loadZip",value:function(e){if(e.loadAsync)throw new f("Docxtemplater doesn't handle JSZip version >=3, see changelog");return this.zip=e,this.updateFileTypeConfig(),this}},{key:"compileFile",value:function(e){var t=this.createTemplateClass(e);t.parse(),this.compiled[e]=t}},{key:"compile",value:function(){var e=this;return Object.keys(this.compiled).length?this:(this.options.xmlFileNames=[],this.modules=p([this.fileTypeConfig.baseModules.map(function(e){return e()}),this.modules]),this.options=this.modules.reduce(function(t,r){return r.optionsTransformer(t,e)},this.options),this.xmlDocuments=this.options.xmlFileNames.reduce(function(t,r){var n=e.zip.files[r].asText();return t[r]=s(n),t},{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments,data:this.data}),this.getTemplatedFiles(),this.setModules({compiled:this.compiled}),this.templatedFiles.forEach(function(t){null!=e.zip.files[t]&&e.compileFile(t)}),this)}},{key:"updateFileTypeConfig",value:function(){var t=this,r={docx:"word/document.xml",pptx:"ppt/presentation.xml",odt:"mimetype"},n=Object.keys(r).reduce(function(e,n){return e||(t.zip.files[r[n]]?n:e)},null);return"odt"===n&&d(n),n||h(),this.fileType=n,this.fileTypeConfig=this.options.fileTypeConfig||e.FileTypeConfig[this.fileType],this}},{key:"render",value:function(){var e=this;return this.compile(),this.mapper=this.modules.reduce(function(e,t){return t.getRenderedMap(e)},{}),Object.keys(this.mapper).forEach(function(t){var r=e.mapper[t],n=r.from,o=r.data,a=e.compiled[n];a.setTags(o),a.render(t),e.zip.file(t,a.content,{createFolders:!0})}),this.sendEvent("syncing-zip"),this.syncZip(),this}},{key:"syncZip",value:function(){var e=this;Object.keys(this.xmlDocuments).forEach(function(t){e.zip.remove(t);var r=u(e.xmlDocuments[t]);return e.zip.file(t,r,{createFolders:!0})})}},{key:"setData",value:function(e){return this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function(t,r){var n=this,o={filePath:r};return Object.keys(i).forEach(function(e){o[e]=n[e]}),o.fileTypeConfig=this.fileTypeConfig,o.modules=this.modules,new e.XmlTemplater(t,o)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath).getFullText()}},{key:"getTemplatedFiles",value:function(){return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.templatedFiles}}]),e}();g.DocUtils=a,g.Errors=r(0),g.XmlTemplater=r(7),g.FileTypeConfig=r(12),g.XmlMatcher=r(4),e.exports=g},function(e,t,r){"use strict";e.exports=window},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var r=f(e,t),n=r.matches.map(function(e){return e.array[2]});return u(l(n.join("")))}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),u=s.wordToUtf8,l=s.convertSpaces,p=s.defaults,c=r(8),f=r(4),h=r(0),d=h.throwMultiError,g=h.throwContentMustBeString,v=r(9),m=r(10),y=r(11),x=y.render;e.exports=function(){function e(t,r){n(this,e),this.fromJson(r),this.setModules({inspect:{filePath:this.filePath}}),this.load(t)}return i(e,[{key:"load",value:function(e){"string"!=typeof e&&g(void 0===e?"undefined":a(e)),this.content=e}},{key:"setTags",value:function(e){return this.tags=null!=e?e:{},this.scopeManager=c({tags:this.tags,parser:this.parser}),this}},{key:"fromJson",value:function(e){this.filePath=e.filePath,this.modules=e.modules,this.fileTypeConfig=e.fileTypeConfig,Object.keys(p).map(function(t){this[t]=null!=e[t]?e[t]:p[t]},this)}},{key:"getFullText",value:function(){return o(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:"parse",value:function(){var e=[];this.xmllexed=v.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{xmllexed:this.xmllexed}});var t=v.parse(this.xmllexed,this.delimiters),r=t.lexed,n=t.errors;e=e.concat(n),this.lexed=r,this.setModules({inspect:{lexed:this.lexed}}),this.parsed=m.parse(this.lexed,this.modules),this.setModules({inspect:{parsed:this.parsed}});var o=m.postparse(this.parsed,this.modules),a=o.postparsed,i=o.errors;return this.postparsed=a,this.setModules({inspect:{postparsed:this.postparsed}}),e=e.concat(i),this.errorChecker(e),this}},{key:"errorChecker",value:function(e){var t=this;e.length&&(this.modules.forEach(function(t){e=t.errorsTransformer(e)}),e.forEach(function(e){e.properties.file=t.filePath}),d(e))}},{key:"render",value:function(e){this.filePath=e;var t={compiled:this.postparsed,tags:this.tags,modules:this.modules,parser:this.parser,nullGetter:this.nullGetter,filePath:this.filePath,render:x};t.scopeManager=c(t);var r=x(t),n=r.errors,o=r.parts;return this.errorChecker(n),this.content=o.join(""),this.setModules({inspect:{content:this.content}}),this}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(0),i=a.XTScopeParserError,s=function(){function e(t){n(this,e),this.scopePath=t.scopePath,this.scopeList=t.scopeList,this.parser=t.parser}return o(e,[{key:"loopOver",value:function(e,t,r){return r=r||!1,this.loopOverValue(this.getValue(e),t,r)}},{key:"functorIfInverted",value:function(e,t,r){e&&t(r)}},{key:"isValueFalsy",value:function(e,t){return null==e||!e||"[object Array]"===t&&0===e.length}},{key:"loopOverValue",value:function(e,t,r){var n=Object.prototype.toString.call(e),o=this.scopeList[this.num];if(this.isValueFalsy(e,n))return this.functorIfInverted(r,t,o);if("[object Array]"!==n)return"[object Object]"===n?this.functorIfInverted(!r,t,e):this.functorIfInverted(!r,t,o);for(var a,i=0;i<e.length;i++)a=e[i],this.functorIfInverted(!r,t,a)}},{key:"getValue",value:function(e,t){this.num=null==t?this.scopeList.length-1:t;var r=void 0,n=void 0,o=this.scopeList[this.num],a=this.parser(e,{scopePath:this.scopePath});try{n=a.get(o,{num:this.num,scopeList:this.scopeList})}catch(t){throw r=new i("Scope parser execution failed"),r.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag "+e+" failed to execute",scope:o,tag:e,rootError:t},r}return null==n&&this.num>0?this.getValue(e,this.num-1):n}},{key:"createSubScopeManager",value:function(t,r){return new e({parser:this.parser,scopeList:this.scopeList.concat(t),scopePath:this.scopePath.concat(r)})}}]),e}();e.exports=function(e){return e.scopePath=[],e.scopeList=[e.tags],new s(e)}},function(e,t,r){"use strict";function n(e,t){return e[0]<=t.offset&&t.offset<e[1]}function o(e,t){return"tag"===e.type&&"start"===e.position&&e.text?(t&&d(e),!0):"tag"===e.type&&"end"===e.position&&e.text?(t||d(e),!1):t}function a(e,t){return e.offset-t.offset}function i(e){var t="start",r=1;"/"===e[e.length-2]&&(t="selfclosing"),"/"===e[1]&&(r=2,t="end");var n=e.indexOf(" "),o=-1===n?e.length-1:n;return{tag:e.slice(r,o),position:t}}function s(e,t,r){for(var n=0,o=e.length,a=v([t.map(function(e){return{tag:e,text:!0}}),r.map(function(e){return{tag:e,text:!1}})]).reduce(function(e,t){return e[t.tag]=t.text,e},{}),s=[];n<o&&-1!==(n=e.indexOf("<",n));){var u=n;n=e.indexOf(">",n);var l=e.slice(u,n+1),p=i(l),c=p.tag,f=p.position,h=a[c];null!=h&&s.push({type:"tag",position:f,text:h,offset:u,value:l,tag:c})}return s}function u(e,t,r){if(0===e.length)return[];var n=[],o=!1,a={offset:0},i=void 0,s=0;e.forEach(function(e){for(;r[s+1]&&!(r[s+1].offset>e.offset);)s++;i=t.substr(a.offset,e.offset-a.offset),"start"===e.position&&o||"end"===e.position&&!o?"start"===e.position?(n.push(f({xtag:i,offset:a.offset})),e.error=!0):(n.push(h({xtag:i,offset:e.offset})),e.error=!0):o=!o,a=e});var u={offset:t.length};return i=t.substr(a.offset,u.offset-a.offset),o&&(n.push(f({xtag:i,offset:a.offset})),u.error=!0),n}function l(e,t,r){var n=[],o=-1;do{-1!==(o=e.indexOf(t,o+1))&&n.push({offset:o,position:r})}while(-1!==o);return n}function p(e){var t=this;this.innerContentParts=e,this.full="",this.parseDelimiters=function(e){t.full=t.innerContentParts.map(function(e){return e.value}).join("");var r=v([l(t.full,e.start,"start"),l(t.full,e.end,"end")]).sort(a),o=0,i=t.innerContentParts.map(function(e){return o+=e.value.length,{offset:o-e.value.length,lIndex:e.lIndex}}),s=u(r,t.full,i),p={start:e.start.length,end:e.end.length},c=0,f=0;t.parsed=i.map(function(e,t){for(var o=e.offset,a=[o,o+this.innerContentParts[t].value.length],i=this.innerContentParts[t].value,s=[];f<r.length&&n(a,r[f]);)s.push(r[f]),f++;var u=[],l=0;c>0&&(l=c,c=0),s.forEach(function(e){var t=i.substr(l,e.offset-o-l);t.length>0&&(u.push({type:"content",value:t,offset:l+o}),l+=t.length);var r={type:"delimiter",position:e.position,offset:l+o};e.error&&(r.error=e.error),u.push(r),l=e.offset-o+p[e.position]}),c=l-i.length;var h=i.substr(l);return h.length>0&&u.push({type:"content",value:h,offset:o}),u},t),t.errors=s}}var c=r(0),f=c.getUnclosedTagException,h=c.getUnopenedTagException,d=c.throwMalformedXml,g=r(1),v=g.concatArrays;e.exports={parse:function(e,t){var r=!1,n=[];e.forEach(function(e){(r=o(e,r))&&"content"===e.type&&n.push(e)});var a=new p(n);a.parseDelimiters(t);var i=[],s=0;return e.forEach(function(e){r=o(e,r),"content"===e.type&&(e.position=r?"insidetag":"outsidetag"),r&&"content"===e.type?(Array.prototype.push.apply(i,a.parsed[s].map(function(e){return"content"===e.type&&(e.position="insidetag"),e})),s++):i.push(e)}),{errors:a.errors,lexed:i}},xmlparse:function(e,t){var r=s(e,t.text,t.other),n=0,o=r.reduce(function(t,r){var o=e.substr(n,r.offset-n);return o.length>0&&t.push({type:"content",value:o}),n=r.offset+r.value.length,delete r.offset,r.value.length>0&&t.push(r),t},[]).map(function(e,t){return e.lIndex=t,e}),a=e.substr(n);return a.length>0&&o.push({type:"content",value:a}),o}}},function(e,t,r){"use strict";function n(e,t,r,n){for(var o=void 0,a=0,i=e.length;a<i;a++){if(o=e[a].parse(t))return o.offset=n,r.push(o),r}return r.push({type:"placeholder",value:t,offset:n}),r}var o=r(1),a=o.wordToUtf8,i=o.concatArrays,s={postparse:function(e,t){function r(e,r){return t.map(function(t){return t.getTraits(e,r)})}function n(e){return t.reduce(function(e,t){var a=t.postparse(e,{postparse:n,getTraits:r});return a.errors?(o=i([o,a.errors]),a.postparsed):a},e)}var o=[];return{postparsed:n(e),errors:o}},parse:function(e,t){var r=!1,o="",i=void 0,s=[];return e.filter(function(e){return!e.error}).reduce(function(e,u){return"delimiter"===u.type?(r="start"===u.position,"end"===u.position?(o=a(o),e=n(t,o,e,i),i=null,Array.prototype.push.apply(e,s),s=[]):i=u.offset,o="",e):r?"content"!==u.type||"insidetag"!==u.position?(s.push(u),e):(o+=u.value,e):(e.push(u),e)},[])}};e.exports=s},function(e,t,r){"use strict";function n(e,t){for(var r=void 0,n=0,o=t.modules.length;n<o;n++){if(r=t.modules[n].render(e,t))return r}return!1}function o(e){var t=e.compiled,r=e.scopeManager,o=e.nullGetter,a=[],u=t.map(function(t){var u=n(t,e);if(u)return u.errors&&(a=s([a,u.errors])),u.value;if("placeholder"===t.type){var p=r.getValue(t.value);return null==p&&(p=o(t)),i(p)}if("content"===t.type||"tag"===t.type)return t.value;l(t)});return{errors:a,parts:u}}var a=r(1),i=a.utf8ToWord,s=a.concatArrays,u=r(0),l=u.throwUnimplementedTagType;e.exports={render:o}},function(e,t,r){"use strict";var n=r(13),o=r(14),a=r(15),i=r(16),s=r(18),u={getTemplatedFiles:function(e){return e.file(/ppt\/(slides|slideMasters)\/(slide|slideMaster)\d+\.xml/).map(function(e){return e.name}).concat(["ppt/presentation.xml"])},textPath:"ppt/slides/slide1.xml",tagsXmlTextArray:["a:t","m:t"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r"],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[n,i,a,s]},l={getTemplatedFiles:function(e){var t=["docProps/core.xml","docProps/app.xml","word/document.xml"];return e.file(/word\/(header|footer)\d+\.xml/).map(function(e){return e.name}).concat(t)},textPath:"word/document.xml",tagsXmlTextArray:["w:t","m:t","vt:lpstr","dc:title","dc:creator","cp:keywords"],tagsXmlLexedArray:["w:tc","w:tr","w:table","w:p","w:r"],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[n,o,i,a,s]};e.exports={docx:l,pptx:u}},function(e,t,r){"use strict";var n=r(1),o=n.mergeObjects,a=/^-([^\s]+)\s(.+)$/,i=r(2),s={name:"LoopModule",prefix:{start:"#",end:"/",dash:"-",inverted:"^"},parse:function(e){var t="placeholder",r=this.prefix;if(e[0]===r.start)return{type:t,value:e.substr(1),expandTo:"auto",module:"loop",location:"start",inverted:!1};if(e[0]===r.inverted)return{type:t,value:e.substr(1),expandTo:"auto",module:"loop",location:"start",inverted:!0};if(e[0]===r.end)return{type:t,value:e.substr(1),module:"loop",location:"end"};if(e[0]===r.dash){return{type:t,value:e.replace(a,"$2"),expandTo:e.replace(a,"$1"),module:"loop",location:"start",inverted:!1}}return null},getTraits:function(e,t){if("expandPair"===e)return t.reduce(function(e,t,r){return"placeholder"===t.type&&"loop"===t.module&&e.push({part:t,offset:r}),e},[])},render:function(e,t){function r(r){var i=t.scopeManager.createSubScopeManager(r,e.value),s=t.render(o({},t,{compiled:e.subparsed,tags:{},scopeManager:i}));n=n.concat(s.parts),a=a.concat(s.errors||[])}if("placeholder"===!e.type||"loop"!==e.module)return null;var n=[],a=[];return t.scopeManager.loopOver(e.value,r,e.inverted),{value:n.join(""),errors:a}}};e.exports=function(){return i(s)}},function(e,t,r){"use strict";var n=r(2),o={name:"SpacePreserveModule",postparse:function(e){var t=[],r=!1,n=e.reduce(function(e,n){return"tag"===n.type&&"start"===n.position&&n.text&&"<w:t>"===n.value&&(r=!0),r?("placeholder"!==n.type||n.module||(t[0].value='<w:t xml:space="preserve">'),t.push(n)):e.push(n),"tag"===n.type&&"end"===n.position&&n.text&&"</w:t>"===n.value&&(Array.prototype.push.apply(e,t),r=!1,t=[]),e},[]);return Array.prototype.push.apply(n,t),n}};e.exports=function(){return n(o)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=e.part,r=e.left,n=e.right,o=e.postparsed,a=e.index,i=o.slice(r+1,n);return i.forEach(function(e,n){n!==a-r-1&&("placeholder"===e.type||"content"===e.type&&"insidetag"===e.position)&&u({paragraphParts:i,part:t})}),t}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3),s=r(0),u=s.throwRawTagShouldBeOnlyTextInParagraph,l=r(2),p=function(){function e(){n(this,e),this.name="RawXmlModule",this.prefix="@"}return a(e,[{key:"optionsTransformer",value:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e}},{key:"parse",value:function(e){return e[0]!==this.prefix?null:{type:"placeholder",value:e.substr(1),module:"rawxml"}}},{key:"postparse",value:function(e){return i.expandToOne(e,{moduleName:"rawxml",getInner:o,expandTo:this.fileTypeConfig.tagRawXml})}},{key:"render",value:function(e,t){if("rawxml"!==e.module)return null;var r=t.scopeManager.getValue(e.value);return null==r&&(r=t.nullGetter(e)),{value:r}}}]),e}();e.exports=function(){return l(new p)}},function(e,t,r){"use strict";function n(e){switch(e.location){case"start":return 1;case"end":return-1;default:v(e)}}function o(e){var t=[],r=[];if(0===e.length)return{pairs:r,errors:t};var i=1,s=a(e,1),u=s[0];if("start"===u.part.location)for(var l=1;l<e.length;l++){var p=e[l];if(0===(i+=n(p.part))){var c=o(e.slice(l+1));return p.part.value!==u.part.value&&""!==p.part.value?t.push(g({tags:[u.part,p.part]})):r=[[u,p]],{pairs:r.concat(c.pairs),errors:t.concat(c.errors)}}}var f=u.part;t.push(d({part:f,location:f.location}));var h=o(e.slice(1));return{pairs:h.pairs,errors:t.concat(h.errors)}}var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=r(17),s=r(1),u=s.getLeft,l=s.getRight,p=r(2),c=r(3),f=c.getExpandToDefault,h=r(0),d=h.getUnmatchedLoopException,g=h.getClosingTagNotMatchOpeningTag,v=h.throwLocationInvalid,m={name:"ExpandPairTrait",postparse:function(e,t){var r=t.getTraits,n=t.postparse,a=r("expandPair",e);a=a.map(function(e){return e||[]}),a=i(a);var s=o(a),p=s.pairs,c=s.errors,h=p.map(function(t){var r=t[0].part.expandTo;if("auto"===r){var n=f(e.slice(t[0].offset,t[1].offset),t);n.error&&c.push(n.error),r=n.value}return r?[u(e,r,t[0].offset),l(e,r,t[1].offset)]:[t[0].offset,t[1].offset]}),d=0,g=void 0;return{postparsed:e.reduce(function(t,r,o){var a=d<p.length&&h[d][0]<=o,i=p[d],s=h[d];if(!a)return t.push(r),t;if(s[0]===o&&(g=[]),i[0].offset!==o&&i[1].offset!==o&&g.push(r),s[1]===o){var u=e[i[0].offset];delete u.location,delete u.expandTo,u.subparsed=n(g),t.push(u),d++}return t},[]),errors:c}}};e.exports=function(){return p(m)}},function(e,t,r){"use strict";function n(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1===r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);if(-1===r)throw new Error("minIndex negative");return r}e.exports=function(e){var t=e.reduce(function(e,t){return e+t.length},0);e=e.filter(function(e){return e.length>0});for(var r=new Array(t),o=e.map(function(){return 0}),a=0;a<=t-1;){var i=n(e,o);r[a]=e[i][o[i]],o[i]++,a++}return r}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2),i=r(0),s=i.getScopeCompilationError,u=function(){function e(){n(this,e),this.name="Render"}return o(e,[{key:"set",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function(e){var t=this;return Object.keys(this.compiled).reduce(function(e,r){return e[r]={from:r,data:t.data},e},e)}},{key:"optionsTransformer",value:function(e,t){return this.parser=t.parser,e}},{key:"postparse",value:function(e){var t=this,r=[];return e.forEach(function(e){if("placeholder"===e.type){var n=e.value;try{t.parser(n)}catch(e){r.push(s({tag:n,rootError:e}))}}}),{postparsed:e,errors:r}}}]),e}();e.exports=function(){return a(new u)}}]);